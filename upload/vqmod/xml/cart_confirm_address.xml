<modification>
	<id>Checkout Confirrm Addresses</id>
	<version>1.1</version>
	<vqmver>1.2.3</vqmver>
	<author>ZG modified</author>
	<file name="catalog/controller/checkout/confirm.php">
        <operation>
            <search position="before"><![CDATA[
if (file_exists(DIR_TEMPLATE . $this->config->get('config_template') . '/template/checkout/confirm.tpl')) {			]]>	</search>
            <add><![CDATA[
			if ($data['shipping_address_format']) {
				$format = $data['shipping_address_format'];
			} else {
				$format = '{firstname} {lastname}' . "\n" . '{company}' . "\n" . '{address_1}' . "\n" . '{address_2}' . "\n" . '{city} {postcode}' . "\n" . '{zone}' . "\n" . '{country}';
			}

			$find = array(
				'{firstname}',
				'{lastname}',
				'{company}',
				'{address_1}',
				'{address_2}',
				'{city}',
				'{postcode}',
				'{zone}',
				'{zone_code}',
				'{country}'
			);

			$replace = array(
				'firstname'	=> $data['shipping_firstname'],
				'lastname' 	=> $data['shipping_lastname'],
				'company' 	=> $data['shipping_company'],
				'address_1' => $data['shipping_address_1'],
				'address_2' => $data['shipping_address_2'],
				'city' 		=> $data['shipping_city'],
				'postcode' 	=> $data['shipping_postcode'],
				'zone' 		=> $data['shipping_zone'],
				'zone_code' => $data['shipping_zone_id'],
				'country' 	=> $data['shipping_country']
			);

			$this->data['shipping_address'] = str_replace(array("\r\n", "\r", "\n"), '<br />', preg_replace(array("/\s\s+/", "/\r\r+/", "/\n\n+/"), '<br />', trim(str_replace($find, $replace, $format))));
	

			if ($data['payment_address_format']) {
				$format = $data['payment_address_format'];
			} else {
				$format = '{firstname} {lastname}' . "\n" . '{company}' . "\n" . '{address_1}' . "\n" . '{address_2}' . "\n" . '{city} {postcode}' . "\n" . '{zone}' . "\n" . '{country}';
			}

			$find = array(
				'{firstname}',
				'{lastname}',
				'{company}',
				'{address_1}',
				'{address_2}',
				'{city}',
				'{postcode}',
				'{zone}',
				'{zone_code}',
				'{country}'
			);

			$replace = array(
				'firstname' => $data['payment_firstname'],
				'lastname' 	=> $data['payment_lastname'],
				'company' 	=> $data['payment_company'],
				'address_1' => $data['payment_address_1'],
				'address_2' => $data['payment_address_2'],
				'city' 		=> $data['payment_city'],
				'postcode' 	=> $data['payment_postcode'],
				'zone' 		=> $data['payment_zone'],
				'zone_code' => $data['payment_zone_id'],
				'country' 	=> $data['payment_country']
			);
			
			$this->data['payment_address'] = str_replace(array("\r\n", "\r", "\n"), '<br />', preg_replace(array("/\s\s+/", "/\r\r+/", "/\n\n+/"), '<br />', trim(str_replace($find, $replace, $format))));
			]]></add>
        </operation>
		
        <operation>
            <search position="after"><![CDATA[
$this->data['column_total'] = $this->language->get('column_total');
			]]>	</search>
            <add><![CDATA[
			$this->data['text_payment_address'] = $this->language->get('text_payment_address');
			$this->data['text_shipping_address'] = $this->language->get('text_shipping_address');
			]]></add>
        </operation>
	</file>
	
	<file name="catalog/view/theme/*/template/checkout/confirm.tpl">
        <operation>
            <search position="before"><![CDATA[
<div class="checkout-product">
			]]>	</search>
            <add><![CDATA[
<div class="left">
	<h2><?php echo $text_payment_address; ?></h2>
		<?php echo $payment_address; ?>
</div>
<div class="right">
	<h2><?php echo $text_shipping_address; ?></h2>
		<?php echo $shipping_address;?>
</div>
<div style="clear:both; margin-top: 10px;">&nbsp;</div>
			]]></add>
        </operation>
	</file>
	
</modification>